# Actory ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ - å®Œå…¨å®Ÿè£…ã‚¬ã‚¤ãƒ‰

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 3.0.0  
**æœ€çµ‚æ›´æ–°æ—¥**: 2024å¹´12æœˆ21æ—¥  
**ä½œæˆè€…**: Enterprise AI Architect  
**å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ **: Actory - è¡Œå‹•ç›´çµå‹ãƒŠãƒ¬ãƒƒã‚¸OS

---

## ğŸ“š ç›®æ¬¡

1. [ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼](#1-ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³è§£](#2-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³è§£)
3. [å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#3-å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)
4. [è©³ç´°ãªã‚³ãƒ¼ãƒ‰å®Ÿè£…ä¾‹](#4-è©³ç´°ãªã‚³ãƒ¼ãƒ‰å®Ÿè£…ä¾‹)
5. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°](#5-ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°)
6. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](#6-ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰)
7. [æœ¬ç•ªç’°å¢ƒã§ã®è€ƒæ…®äº‹é …](#7-æœ¬ç•ªç’°å¢ƒã§ã®è€ƒæ…®äº‹é …)
8. [è‡ªå‹•å®Ÿè£…ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](#8-è‡ªå‹•å®Ÿè£…ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ)

---

## 1. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

### 1.1 ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

Actoryã¯ã€éŸ³å£°éŒ²éŸ³ã‹ã‚‰è­°äº‹éŒ²ç”Ÿæˆã€ã‚¿ã‚¹ã‚¯ç®¡ç†ã€ãƒŠãƒ¬ãƒƒã‚¸è“„ç©ã¾ã§ã‚’ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«çµ±åˆã—ãŸã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã®AIãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆãƒ—ãƒ­ãƒ€ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ä»¥ä¸‹ã®ç‰¹å¾´ã‚’æŒã¤åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ï¼š

- **ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: å„æ©Ÿèƒ½ã‚’ç‹¬ç«‹ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè£…
- **ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹è¨­è¨ˆ**: éåŒæœŸå‡¦ç†ã«ã‚ˆã‚‹é«˜ã„ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£
- **ã‚¨ãƒƒã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**: Tursoã«ã‚ˆã‚‹ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·
- **AIãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ**: LLMã‚’ä¸­æ ¸ã¨ã—ãŸã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªå‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

### 1.2 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è¨­è¨ˆåŸå‰‡

1. **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ**: æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚’å‰æã¨ã—ãŸè¨­è¨ˆ
2. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆãƒˆãƒ¬ãƒ©ãƒ³ã‚¹**: å˜ä¸€éšœå®³ç‚¹ã‚’æ’é™¤ã—ãŸå†—é•·æ§‹æˆ
3. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**: åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¨ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã®æ´»ç”¨
4. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚¤ãƒ‡ã‚¶ã‚¤ãƒ³**: ã‚¼ãƒ­ãƒˆãƒ©ã‚¹ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ¡ç”¨
5. **ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£**: åŒ…æ‹¬çš„ãªãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã¨ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°

### 1.3 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸å®šç†ç”±

| æŠ€è¡“ | é¸å®šç†ç”± | ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå¯¾å¿œ |
|------|----------|---------------------|
| Next.js 14 | React 19ã®éæ¸¡æœŸãƒªã‚¹ã‚¯å›é¿ã€LTSã‚µãƒãƒ¼ãƒˆ | âœ… |
| Capacitor | iOSãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰éŒ²éŸ³ã®å¿…é ˆè¦ä»¶ | âœ… |
| Turso | DiskANN Vector Searchã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ | âœ… |
| tRPC | å‹å®‰å…¨ãªã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰é€šä¿¡ | âœ… |
| OpenAI Structured Outputs | 100%å‹å®‰å…¨ãªAIå‡ºåŠ› | âœ… |

### 1.4 ã‚·ã‚¹ãƒ†ãƒ è¦æ¨¡ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™

- **åŒæ™‚ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°**: 10,000ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆåˆæœŸï¼‰ã€100,000ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆæ‹¡å¼µæ™‚ï¼‰
- **ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·**: APIå¿œç­” < 200msï¼ˆP95ï¼‰ã€< 500msï¼ˆP99ï¼‰
- **å¯ç”¨æ€§**: 99.9% SLAï¼ˆå¹´é–“ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  < 8.76æ™‚é–“ï¼‰
- **ãƒ‡ãƒ¼ã‚¿å‡¦ç†**: 1æ™‚é–“ã‚ãŸã‚Š100ä¸‡ä»¶ã®éŸ³å£°å‡¦ç†ã€10ä¸‡ä»¶ã®è­°äº‹éŒ²ç”Ÿæˆ

---

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³è§£

### 2.1 ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Global Load Balancer (Cloudflare)             â”‚
â”‚                    DDoS Protection + WAF + CDN                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Gateway Layer (Kong/AWS API Gateway)     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Rate Limit  â”‚  â”‚ Auth Service â”‚  â”‚ Request Log   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Application Layer (Next.js Edge Functions)   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Frontend (Next.js 14 + React 18)                       â”‚  â”‚
â”‚  â”‚  - Server Components (SSR/SSG)                           â”‚  â”‚
â”‚  â”‚  - Client Components (Interactivity)                      â”‚  â”‚
â”‚  â”‚  - Edge Runtime (Global Distribution)                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  API Routes (tRPC + REST)                               â”‚  â”‚
â”‚  â”‚  - Authentication (BetterAuth)                           â”‚  â”‚
â”‚  â”‚  - Business Logic (Server Actions)                       â”‚  â”‚
â”‚  â”‚  - File Upload (Multipart Handling)                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Microservices Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Audio        â”‚  â”‚ AI Processing â”‚  â”‚ Notificationâ”‚          â”‚
â”‚  â”‚ Processing   â”‚  â”‚ Service       â”‚  â”‚ Service     â”‚          â”‚
â”‚  â”‚ Service      â”‚  â”‚               â”‚  â”‚             â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Vector       â”‚  â”‚ Content      â”‚  â”‚ Integration  â”‚          â”‚
â”‚  â”‚ Search       â”‚  â”‚ Generation   â”‚  â”‚ Service      â”‚          â”‚
â”‚  â”‚ Service      â”‚  â”‚ Service      â”‚  â”‚              â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Message Queue (RabbitMQ / AWS SQS)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Audio Queue  â”‚  â”‚ AI Queue     â”‚  â”‚ Event Queue  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Data Layer                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Turso (LibSQL) - Primary Database                        â”‚  â”‚
â”‚  â”‚  - DiskANN Vector Index (ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢)                  â”‚  â”‚
â”‚  â”‚  - FTS5 Full-Text Search (å…¨æ–‡æ¤œç´¢)                      â”‚  â”‚
â”‚  â”‚  - Global Replication (ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·)                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ S3 Compatible Storage (MinIO / AWS S3)                  â”‚  â”‚
â”‚  â”‚  - Audio Files (éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«)                           â”‚  â”‚
â”‚  â”‚  - Waveform Data (æ³¢å½¢ãƒ‡ãƒ¼ã‚¿)                            â”‚  â”‚
â”‚  â”‚  - Generated Content (ç”Ÿæˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„)                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Redis Cluster (Cache + Session Store)                   â”‚  â”‚
â”‚  â”‚  - Session Management                                    â”‚  â”‚
â”‚  â”‚  - Rate Limiting                                         â”‚  â”‚
â”‚  â”‚  - Real-time Data                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    External Services                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ OpenAI   â”‚ â”‚ Notion   â”‚ â”‚ Slack    â”‚ â”‚ Google   â”‚           â”‚
â”‚  â”‚ Whisper  â”‚ â”‚ API      â”‚ â”‚ API      â”‚ â”‚ OAuth    â”‚           â”‚
â”‚  â”‚ GPT-4    â”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¥ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°

#### 2.2.1 ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆFrontendï¼‰

**Next.js 14 App Routeræ§‹æˆ**:

```
app/
â”œâ”€â”€ (auth)/
â”‚   â””â”€â”€ login/
â”‚       â””â”€â”€ page.tsx          # èªè¨¼ãƒšãƒ¼ã‚¸
â”œâ”€â”€ (dashboard)/
â”‚   â”œâ”€â”€ layout.tsx            # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”œâ”€â”€ page.tsx              # ãƒ›ãƒ¼ãƒ ç”»é¢
â”‚   â”œâ”€â”€ record/
â”‚   â”‚   â””â”€â”€ page.tsx          # éŒ²éŸ³ç”»é¢
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â””â”€â”€ page.tsx          # AIãƒãƒ£ãƒƒãƒˆ
â”‚   â””â”€â”€ projects/
â”‚       â””â”€â”€ [id]/
â”‚           â””â”€â”€ page.tsx      # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ trpc/
â”‚   â”‚   â””â”€â”€ [trpc]/
â”‚   â”‚       â””â”€â”€ route.ts      # tRPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ recordings/
â”‚   â”‚   â””â”€â”€ upload/
â”‚   â”‚       â””â”€â”€ route.ts      # éŒ²éŸ³ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
â”‚   â””â”€â”€ webhooks/
â”‚       â””â”€â”€ route.ts          # Webhookå—ä¿¡
â””â”€â”€ layout.tsx                # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
```

**Server Components vs Client Componentsæˆ¦ç•¥**:

- **Server Components**: ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã€SEOé‡è¦ãƒšãƒ¼ã‚¸ã€é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
- **Client Components**: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–UIã€ãƒ•ã‚©ãƒ¼ãƒ ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

#### 2.2.2 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆBackendï¼‰

**tRPC Routeræ§‹æˆ**:

```typescript
// server/routers/_app.ts
export const appRouter = router({
  // èªè¨¼
  auth: authRouter,
  
  // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†
  project: projectRouter,
  
  // éŒ²éŸ³ãƒ»è­°äº‹éŒ²
  recording: recordingRouter,
  meetingNote: meetingNoteRouter,
  
  // ã‚¿ã‚¹ã‚¯ç®¡ç†
  task: taskRouter,
  taskCandidate: taskCandidateRouter,
  
  // AIæ©Ÿèƒ½
  ai: aiRouter,
  
  // ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
  file: fileRouter,
  
  // ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†
  folder: folderRouter,
  
  // ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†
  context: contextRouter,
  
  // å¤–éƒ¨é€£æº
  integration: integrationRouter,
  
  // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆ
  content: contentRouter,
});
```

**Server Actionsãƒ‘ã‚¿ãƒ¼ãƒ³**:

```typescript
// server/actions/recording.ts
'use server';

import { auth } from '@/auth';
import { db } from '@/db';
import { recordings } from '@/db/schema';

export async function uploadRecording(formData: FormData) {
  const session = await auth();
  if (!session?.user) throw new Error('Unauthorized');
  
  const audioFile = formData.get('audio') as File;
  // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†...
  
  return { success: true, recordingId: newRecording.id };
}
```

#### 2.2.3 ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å±¤

**ã‚µãƒ¼ãƒ“ã‚¹é–“é€šä¿¡ãƒ‘ã‚¿ãƒ¼ãƒ³**:

1. **åŒæœŸé€šä¿¡**: gRPCï¼ˆä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãŒå¿…è¦ãªå ´åˆï¼‰
2. **éåŒæœŸé€šä¿¡**: RabbitMQ / AWS SQSï¼ˆã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ï¼‰
3. **ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥**: Istioï¼ˆãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ç®¡ç†ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼‰

**å„ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã®è²¬å‹™**:

- **Audio Processing Service**: FFmpegå‡¦ç†ã€éŸ³å£°åˆ†å‰²ã€æ³¢å½¢ç”Ÿæˆ
- **AI Processing Service**: Whisperæ–‡å­—èµ·ã“ã—ã€GPT-4è­°äº‹éŒ²ç”Ÿæˆã€ã‚¿ã‚¹ã‚¯æŠ½å‡º
- **Vector Search Service**: ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã€ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢
- **Notification Service**: ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã€ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã€Slacké€£æº

### 2.3 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ

#### 2.3.1 éŒ²éŸ³â†’è­°äº‹éŒ²ç”Ÿæˆãƒ•ãƒ­ãƒ¼

```
1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆCapacitor Appï¼‰
   â†“ éŒ²éŸ³ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
2. API Gateway
   â†“ èªè¨¼ãƒ»ãƒ¬ãƒ¼ãƒˆåˆ¶é™
3. Next.js API Route
   â†“ S3ã«ä¿å­˜
4. Message Queue (Audio Queue)
   â†“ éåŒæœŸå‡¦ç†
5. Audio Processing Service
   â†“ FFmpegåˆ†å‰²
6. AI Processing Service
   â†“ Whisper APIå‘¼ã³å‡ºã—
7. AI Processing Service
   â†“ GPT-4è­°äº‹éŒ²ç”Ÿæˆ
8. Database (Turso)
   â†“ ä¿å­˜
9. WebSocket / SSE
   â†“ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥
10. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆUIæ›´æ–°ï¼‰
```

#### 2.3.2 ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```typescript
// ã‚¤ãƒ™ãƒ³ãƒˆå®šç¾©
export const Events = {
  RECORDING_UPLOADED: 'recording.uploaded',
  TRANSCRIPTION_COMPLETED: 'transcription.completed',
  MEETING_NOTE_GENERATED: 'meeting_note.generated',
  TASK_EXTRACTED: 'task.extracted',
  CONTENT_SUGGESTED: 'content.suggested',
} as const;

// ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼
export const eventHandlers = {
  [Events.RECORDING_UPLOADED]: async (event: RecordingUploadedEvent) => {
    // éŸ³å£°å‡¦ç†ã‚’é–‹å§‹
    await audioProcessingService.process(event.recordingId);
  },
  
  [Events.TRANSCRIPTION_COMPLETED]: async (event: TranscriptionCompletedEvent) => {
    // è­°äº‹éŒ²ç”Ÿæˆã‚’é–‹å§‹
    await aiProcessingService.generateMeetingNote(event.transcriptionId);
  },
  
  // ...
};
```

### 2.4 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### 2.4.1 ã‚¼ãƒ­ãƒˆãƒ©ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«

- **èªè¨¼**: ã™ã¹ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§èªè¨¼ã‚’è¦æ±‚
- **èªå¯**: ãƒªã‚½ãƒ¼ã‚¹å˜ä½ã§ã®æ¨©é™ãƒã‚§ãƒƒã‚¯
- **æš—å·åŒ–**: è»¢é€æ™‚ï¼ˆTLS 1.3ï¼‰ã¨ä¿å­˜æ™‚ï¼ˆAES-256ï¼‰
- **ç›£æŸ»ãƒ­ã‚°**: ã™ã¹ã¦ã®æ“ä½œã‚’è¨˜éŒ²

#### 2.4.2 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ã‚¤ãƒ¤ãƒ¼

```
1. WAF (Web Application Firewall)
   - SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–
   - XSSå¯¾ç­–
   - DDoSå¯¾ç­–

2. API Gateway
   - ãƒ¬ãƒ¼ãƒˆåˆ¶é™
   - èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
   - IPãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆ

3. Application Layer
   - å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
   - å‡ºåŠ›ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
   - CSRFå¯¾ç­–

4. Database Layer
   - Row-Level Security
   - æš—å·åŒ–ã‚«ãƒ©ãƒ 
   - ç›£æŸ»ãƒ­ã‚°
```

---

## 3. å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 3.1 ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³

#### 3.1.1 ã‚µãƒ¼ãƒ“ã‚¹é–“é€šä¿¡ãƒ‘ã‚¿ãƒ¼ãƒ³

**åŒæœŸé€šä¿¡ï¼ˆgRPCï¼‰**:

```typescript
// proto/audio_processing.proto
syntax = "proto3";

service AudioProcessingService {
  rpc ProcessAudio(ProcessAudioRequest) returns (ProcessAudioResponse);
  rpc GetStatus(GetStatusRequest) returns (GetStatusResponse);
}

message ProcessAudioRequest {
  string recording_id = 1;
  string s3_key = 2;
}

message ProcessAudioResponse {
  string job_id = 1;
  string status = 2;
}
```

**éåŒæœŸé€šä¿¡ï¼ˆRabbitMQï¼‰**:

```typescript
// server/services/event-bus.ts
import amqp from 'amqplib';

export class EventBus {
  private connection: amqp.Connection;
  private channel: amqp.Channel;

  async connect() {
    this.connection = await amqp.connect(process.env.RABBITMQ_URL!);
    this.channel = await this.connection.createChannel();
    
    // ã‚¨ã‚¯ã‚¹ãƒã‚§ãƒ³ã‚¸ã‚’å®£è¨€
    await this.channel.assertExchange('actory.events', 'topic', {
      durable: true,
    });
  }

  async publish(event: string, data: any) {
    await this.channel.publish('actory.events', event, Buffer.from(JSON.stringify(data)), {
      persistent: true,
    });
  }

  async subscribe(event: string, handler: (data: any) => Promise<void>) {
    const queue = await this.channel.assertQueue('', { exclusive: true });
    await this.channel.bindQueue(queue.queue, 'actory.events', event);
    
    await this.channel.consume(queue.queue, async (msg) => {
      if (msg) {
        const data = JSON.parse(msg.content.toString());
        await handler(data);
        this.channel.ack(msg);
      }
    });
  }
}
```

#### 3.1.2 ã‚µãƒ¼ãƒ“ã‚¹ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒª

**Consul / Eurekaãƒ‘ã‚¿ãƒ¼ãƒ³**:

```typescript
// server/services/service-discovery.ts
import { Consul } from 'consul';

export class ServiceDiscovery {
  private consul: Consul;

  constructor() {
    this.consul = new Consul({
      host: process.env.CONSUL_HOST || 'localhost',
      port: process.env.CONSUL_PORT || '8500',
    });
  }

  async registerService(service: {
    name: string;
    address: string;
    port: number;
    health: string;
  }) {
    await this.consul.agent.service.register({
      name: service.name,
      address: service.address,
      port: service.port,
      check: {
        http: service.health,
        interval: '10s',
      },
    });
  }

  async discoverService(serviceName: string) {
    const services = await this.consul.health.service({
      service: serviceName,
      passing: true,
    });
    
    // ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°ï¼ˆãƒ©ã‚¦ãƒ³ãƒ‰ãƒ­ãƒ“ãƒ³ï¼‰
    return this.selectService(services);
  }
}
```

### 3.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³

#### 3.2.1 CQRSï¼ˆCommand Query Responsibility Segregationï¼‰

```typescript
// Commandå´ï¼ˆæ›¸ãè¾¼ã¿ï¼‰
export class CommandHandler {
  async createMeetingNote(command: CreateMeetingNoteCommand) {
    // ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œ
    await eventStore.append({
      aggregateId: command.id,
      eventType: 'MeetingNoteCreated',
      data: command,
    });
  }
}

// Queryå´ï¼ˆèª­ã¿å–ã‚Šï¼‰
export class QueryHandler {
  async getMeetingNote(id: number) {
    // èª­ã¿å–ã‚Šå°‚ç”¨ã®æœ€é©åŒ–ã•ã‚ŒãŸã‚¯ã‚¨ãƒª
    return await db.query.meetingNotes.findFirst({
      where: eq(meetingNotes.id, id),
      with: {
        project: true,
        file: true,
      },
    });
  }
}
```

#### 3.2.2 ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°

```typescript
// server/event-store.ts
export class EventStore {
  async append(event: DomainEvent) {
    await db.insert(eventStore).values({
      aggregateId: event.aggregateId,
      eventType: event.eventType,
      data: JSON.stringify(event.data),
      version: await this.getNextVersion(event.aggregateId),
      timestamp: new Date(),
    });
  }

  async getEvents(aggregateId: string): Promise<DomainEvent[]> {
    const events = await db
      .select()
      .from(eventStore)
      .where(eq(eventStore.aggregateId, aggregateId))
      .orderBy(asc(eventStore.version));
    
    return events.map(e => ({
      aggregateId: e.aggregateId,
      eventType: e.eventType,
      data: JSON.parse(e.data),
      version: e.version,
    }));
  }

  async rebuildAggregate(aggregateId: string) {
    const events = await this.getEvents(aggregateId);
    let aggregate = new MeetingNoteAggregate();
    
    for (const event of events) {
      aggregate.apply(event);
    }
    
    return aggregate;
  }
}
```

### 3.3 ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥

#### 3.3.1 ãƒãƒ«ãƒãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥

```typescript
// server/cache/multi-layer-cache.ts
export class MultiLayerCache {
  private l1Cache: Map<string, any>; // ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥
  private l2Cache: Redis; // Redisã‚­ãƒ£ãƒƒã‚·ãƒ¥
  private l3Cache: Database; // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

  async get<T>(key: string): Promise<T | null> {
    // L1: ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒª
    if (this.l1Cache.has(key)) {
      return this.l1Cache.get(key);
    }

    // L2: Redis
    const l2Value = await this.l2Cache.get(key);
    if (l2Value) {
      this.l1Cache.set(key, l2Value);
      return l2Value;
    }

    // L3: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
    const l3Value = await this.l3Cache.query(key);
    if (l3Value) {
      await this.l2Cache.set(key, l3Value, { ttl: 3600 });
      this.l1Cache.set(key, l3Value);
      return l3Value;
    }

    return null;
  }

  async set(key: string, value: any, options?: { ttl?: number }) {
    this.l1Cache.set(key, value);
    await this.l2Cache.set(key, value, { ttl: options?.ttl || 3600 });
  }

  async invalidate(key: string) {
    this.l1Cache.delete(key);
    await this.l2Cache.del(key);
  }
}
```

#### 3.3.2 ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¤ãƒ³ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥

```typescript
// Cache-asideãƒ‘ã‚¿ãƒ¼ãƒ³
export async function getMeetingNote(id: number) {
  const cacheKey = `meeting_note:${id}`;
  
  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å–å¾—ã‚’è©¦ã¿ã‚‹
  let note = await cache.get(cacheKey);
  
  if (!note) {
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—
    note = await db.query.meetingNotes.findFirst({
      where: eq(meetingNotes.id, id),
    });
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜
    if (note) {
      await cache.set(cacheKey, note, { ttl: 3600 });
    }
  }
  
  return note;
}

// Write-throughãƒ‘ã‚¿ãƒ¼ãƒ³
export async function updateMeetingNote(id: number, data: Partial<MeetingNote>) {
  // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ›´æ–°
  await db.update(meetingNotes)
    .set(data)
    .where(eq(meetingNotes.id, id));
  
  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚‚æ›´æ–°
  const updated = await db.query.meetingNotes.findFirst({
    where: eq(meetingNotes.id, id),
  });
  
  await cache.set(`meeting_note:${id}`, updated, { ttl: 3600 });
}
```

### 3.4 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³

#### 3.4.1 ãƒªãƒˆãƒ©ã‚¤ã¨ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼

```typescript
// server/utils/retry.ts
export async function retryWithBackoff<T>(
  fn: () => Promise<T>,
  options: {
    maxRetries?: number;
    initialDelay?: number;
    maxDelay?: number;
    factor?: number;
  } = {}
): Promise<T> {
  const {
    maxRetries = 3,
    initialDelay = 1000,
    maxDelay = 10000,
    factor = 2,
  } = options;

  let lastError: Error;
  let delay = initialDelay;

  for (let attempt = 0; attempt <= maxRetries; attempt++) {
    try {
      return await fn();
    } catch (error) {
      lastError = error as Error;
      
      if (attempt < maxRetries) {
        await sleep(delay);
        delay = Math.min(delay * factor, maxDelay);
      }
    }
  }

  throw lastError!;
}

// ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼
export class CircuitBreaker {
  private state: 'closed' | 'open' | 'half-open' = 'closed';
  private failures = 0;
  private lastFailureTime = 0;
  private readonly threshold = 5;
  private readonly timeout = 60000; // 1åˆ†

  async execute<T>(fn: () => Promise<T>): Promise<T> {
    if (this.state === 'open') {
      if (Date.now() - this.lastFailureTime > this.timeout) {
        this.state = 'half-open';
      } else {
        throw new Error('Circuit breaker is open');
      }
    }

    try {
      const result = await fn();
      this.onSuccess();
      return result;
    } catch (error) {
      this.onFailure();
      throw error;
    }
  }

  private onSuccess() {
    this.failures = 0;
    this.state = 'closed';
  }

  private onFailure() {
    this.failures++;
    this.lastFailureTime = Date.now();
    
    if (this.failures >= this.threshold) {
      this.state = 'open';
    }
  }
}
```

---

## 4. è©³ç´°ãªã‚³ãƒ¼ãƒ‰å®Ÿè£…ä¾‹

### 4.1 ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…ä¾‹

#### 4.1.1 Audio Processing Service

```typescript
// services/audio-processing/src/index.ts
import express from 'express';
import { AudioProcessor } from './audio-processor';
import { EventBus } from './event-bus';

const app = express();
app.use(express.json());

const audioProcessor = new AudioProcessor();
const eventBus = new EventBus();

// éŸ³å£°å‡¦ç†ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
app.post('/process', async (req, res) => {
  const { recordingId, s3Key } = req.body;
  
  try {
    // éåŒæœŸå‡¦ç†ã‚’é–‹å§‹
    const jobId = await audioProcessor.process({
      recordingId,
      s3Key,
    });
    
    res.json({ jobId, status: 'processing' });
    
    // ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œ
    await eventBus.publish('audio.processing.started', {
      recordingId,
      jobId,
    });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
app.get('/status/:jobId', async (req, res) => {
  const { jobId } = req.params;
  const status = await audioProcessor.getStatus(jobId);
  res.json(status);
});

// ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
app.get('/health', (req, res) => {
  res.json({ status: 'healthy' });
});

app.listen(3001, () => {
  console.log('Audio Processing Service listening on port 3001');
});
```

```typescript
// services/audio-processing/src/audio-processor.ts
import { exec } from 'child_process';
import { promisify } from 'util';
import { S3Client, GetObjectCommand } from '@aws-sdk/client-s3';
import { splitAudioBySilence } from './ffmpeg-utils';

const execAsync = promisify(exec);

export class AudioProcessor {
  private s3Client: S3Client;
  private jobs: Map<string, ProcessingJob> = new Map();

  constructor() {
    this.s3Client = new S3Client({
      region: process.env.AWS_REGION || 'us-east-1',
    });
  }

  async process(options: { recordingId: string; s3Key: string }): Promise<string> {
    const jobId = `job-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
    
    this.jobs.set(jobId, {
      id: jobId,
      recordingId: options.recordingId,
      status: 'processing',
      progress: 0,
      createdAt: new Date(),
    });

    // éåŒæœŸã§å‡¦ç†ã‚’å®Ÿè¡Œ
    this.processAsync(jobId, options).catch(error => {
      console.error(`Job ${jobId} failed:`, error);
      const job = this.jobs.get(jobId);
      if (job) {
        job.status = 'failed';
        job.error = error.message;
      }
    });

    return jobId;
  }

  private async processAsync(jobId: string, options: { recordingId: string; s3Key: string }) {
    const job = this.jobs.get(jobId);
    if (!job) throw new Error('Job not found');

    try {
      // 1. S3ã‹ã‚‰éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
      job.progress = 10;
      const audioBuffer = await this.downloadFromS3(options.s3Key);

      // 2. ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
      const tempPath = `/tmp/${jobId}.mp3`;
      await fs.writeFile(tempPath, audioBuffer);

      // 3. FFmpegã§ç„¡éŸ³æ¤œçŸ¥åˆ†å‰²
      job.progress = 30;
      const chunks = await splitAudioBySilence(tempPath);

      // 4. å„ãƒãƒ£ãƒ³ã‚¯ã‚’S3ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
      job.progress = 50;
      const chunkKeys = await Promise.all(
        chunks.map((chunk, index) => this.uploadChunk(chunk, options.recordingId, index))
      );

      // 5. æ³¢å½¢ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
      job.progress = 70;
      const waveformData = await this.generateWaveform(tempPath);

      // 6. å®Œäº†
      job.progress = 100;
      job.status = 'completed';
      job.result = {
        chunks: chunkKeys,
        waveform: waveformData,
      };

      // ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œ
      await this.eventBus.publish('audio.processing.completed', {
        recordingId: options.recordingId,
        jobId,
        chunks: chunkKeys,
        waveform: waveformData,
      });
    } catch (error) {
      job.status = 'failed';
      job.error = error.message;
      throw error;
    }
  }

  async getStatus(jobId: string) {
    const job = this.jobs.get(jobId);
    if (!job) throw new Error('Job not found');
    
    return {
      id: job.id,
      status: job.status,
      progress: job.progress,
      result: job.result,
      error: job.error,
    };
  }

  private async downloadFromS3(key: string): Promise<Buffer> {
    const command = new GetObjectCommand({
      Bucket: process.env.S3_BUCKET!,
      Key: key,
    });
    
    const response = await this.s3Client.send(command);
    const chunks: Uint8Array[] = [];
    
    for await (const chunk of response.Body as any) {
      chunks.push(chunk);
    }
    
    return Buffer.concat(chunks);
  }
}
```

#### 4.1.2 AI Processing Service

```typescript
// services/ai-processing/src/index.ts
import express from 'express';
import { AIService } from './ai-service';
import { EventBus } from './event-bus';

const app = express();
app.use(express.json());

const aiService = new AIService();
const eventBus = new EventBus();

// ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­: æ–‡å­—èµ·ã“ã—å®Œäº†ã‚’å¾…ã¤
eventBus.subscribe('transcription.completed', async (event) => {
  const { transcriptionId, transcription } = event;
  
  try {
    // è­°äº‹éŒ²ç”Ÿæˆã‚’é–‹å§‹
    const meetingNote = await aiService.generateMeetingNote({
      transcriptionId,
      transcription,
      userId: event.userId,
      projectId: event.projectId,
    });
    
    // ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œ
    await eventBus.publish('meeting_note.generated', {
      meetingNoteId: meetingNote.id,
      transcriptionId,
    });
  } catch (error) {
    console.error('Failed to generate meeting note:', error);
  }
});

app.listen(3002, () => {
  console.log('AI Processing Service listening on port 3002');
});
```

```typescript
// services/ai-processing/src/ai-service.ts
import { OpenAI } from 'openai';
import { db } from '@shared/database';

export class AIService {
  private openai: OpenAI;

  constructor() {
    this.openai = new OpenAI({
      apiKey: process.env.OPENAI_API_KEY!,
    });
  }

  async generateMeetingNote(options: {
    transcriptionId: number;
    transcription: string;
    userId: number;
    projectId: number;
  }) {
    // Structured Outputsã§è­°äº‹éŒ²ã‚’ç”Ÿæˆ
    const completion = await this.openai.chat.completions.create({
      model: 'gpt-4',
      messages: [
        {
          role: 'system',
          content: `ã‚ãªãŸã¯ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªè­°äº‹éŒ²ç”ŸæˆAIã§ã™ã€‚
æƒ…å ±ã‚’ä¸€åˆ‡çœç•¥ã›ãšã€æ§‹é€ åŒ–ã«ã‚ˆã£ã¦èª­ã¿ã‚„ã™ãã—ã¦ãã ã•ã„ã€‚`,
        },
        {
          role: 'user',
          content: `ä»¥ä¸‹ã®æ–‡å­—èµ·ã“ã—ã‹ã‚‰è­°äº‹éŒ²ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„:\n\n${options.transcription}`,
        },
      ],
      response_format: {
        type: 'json_schema',
        json_schema: {
          name: 'meeting_note',
          schema: meetingNoteSchema,
          strict: true,
        },
      },
    });

    const result = JSON.parse(completion.choices[0].message.content!);

    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
    const meetingNote = await db.insert(meetingNotes).values({
      userId: options.userId,
      projectId: options.projectId,
      title: result.title,
      summary: result.summary,
      agendaItems: JSON.stringify(result.agendaItems),
      discussionDetails: result.discussionDetails,
      decisions: JSON.stringify(result.decisions),
      actionItems: JSON.stringify(result.actionItems),
      formattedMinutes: this.formatAsMarkdown(result),
    });

    return meetingNote;
  }

  async extractTasks(meetingNoteId: number) {
    const note = await db.query.meetingNotes.findFirst({
      where: eq(meetingNotes.id, meetingNoteId),
    });

    if (!note) throw new Error('Meeting note not found');

    // Function Callingã§ã‚¿ã‚¹ã‚¯ã‚’æŠ½å‡º
    const completion = await this.openai.chat.completions.create({
      model: 'gpt-4',
      messages: [
        {
          role: 'system',
          content: 'ä¼šè­°ã®å†…å®¹ã‹ã‚‰å…·ä½“çš„ãªã‚¿ã‚¹ã‚¯ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚',
        },
        {
          role: 'user',
          content: note.formattedMinutes,
        },
      ],
      tools: [
        {
          type: 'function',
          function: {
            name: 'create_task',
            description: 'ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¾ã™',
            parameters: {
              type: 'object',
              properties: {
                title: { type: 'string' },
                description: { type: 'string' },
                dueDate: { type: 'string', format: 'date' },
                priority: { type: 'string', enum: ['high', 'medium', 'low'] },
              },
              required: ['title', 'description'],
            },
          },
        },
      ],
      tool_choice: 'required',
    });

    const toolCalls = completion.choices[0].message.tool_calls || [];
    const tasks = toolCalls.map(call => JSON.parse(call.function.arguments));

    // ã‚¿ã‚¹ã‚¯å€™è£œã¨ã—ã¦ä¿å­˜
    for (const task of tasks) {
      await db.insert(taskCandidates).values({
        userId: note.userId,
        recordingId: note.recordingId,
        title: task.title,
        description: task.description,
        suggestedDueDate: task.dueDate ? new Date(task.dueDate).getTime() : null,
        suggestedPriority: task.priority || 'medium',
      });
    }

    return tasks;
  }

  private formatAsMarkdown(data: any): string {
    return `# ${data.title}

## è¦ç´„
${data.summary}

## è­°é¡Œ
${data.agendaItems.map((item: string) => `- ${item}`).join('\n')}

## è­°è«–å†…å®¹
${data.discussionDetails}

## æ±ºå®šäº‹é …
${data.decisions.map((d: any) => `- **${d.item}**: ${d.details || ''}`).join('\n')}

## ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ 
${data.actionItems.map((a: any) => `- ${a.title} (${a.priority || 'medium'})`).join('\n')}
`;
  }
}
```

### 4.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®Ÿè£…ä¾‹

#### 4.2.1 Turso Vector Searchå®Ÿè£…

```typescript
// server/lib/vector-search.ts
import { db } from '@/db';
import { sql } from 'drizzle-orm';
import { OpenAI } from 'openai';

const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY! });

export class VectorSearchService {
  // ãƒ™ã‚¯ãƒˆãƒ«åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆã—ã¦ä¿å­˜
  async indexKnowledge(knowledgeId: number, content: string) {
    // OpenAI Embeddings APIã§ãƒ™ã‚¯ãƒˆãƒ«ã‚’ç”Ÿæˆ
    const embedding = await openai.embeddings.create({
      model: 'text-embedding-3-large',
      input: content,
    });

    const vector = embedding.data[0].embedding;

    // Tursoã«ä¿å­˜ï¼ˆDiskANNã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨ï¼‰
    await db.execute(sql`
      INSERT INTO knowledge_embeddings (id, embedding, content)
      VALUES (${knowledgeId}, ${JSON.stringify(vector)}, ${content})
      ON CONFLICT(id) DO UPDATE SET
        embedding = ${JSON.stringify(vector)},
        content = ${content}
    `);
  }

  // é¡ä¼¼ãƒŠãƒ¬ãƒƒã‚¸ã‚’æ¤œç´¢
  async searchSimilar(
    query: string,
    limit: number = 5
  ): Promise<Array<{ id: number; content: string; distance: number }>> {
    // ã‚¯ã‚¨ãƒªã‚’ãƒ™ã‚¯ãƒˆãƒ«åŒ–
    const queryEmbedding = await openai.embeddings.create({
      model: 'text-embedding-3-large',
      input: query,
    });

    const queryVector = queryEmbedding.data[0].embedding;

    // DiskANNã§é¡ä¼¼æ¤œç´¢
    const results = await db.execute(sql`
      SELECT 
        id,
        content,
        vector_distance(embedding, ${JSON.stringify(queryVector)}) as distance
      FROM knowledge_embeddings
      ORDER BY distance ASC
      LIMIT ${limit}
    `);

    return results as any;
  }

  // ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ï¼ˆãƒ™ã‚¯ãƒˆãƒ« + å…¨æ–‡æ¤œç´¢ï¼‰
  async hybridSearch(
    query: string,
    limit: number = 5
  ): Promise<Array<{ id: number; content: string; score: number }>> {
    // ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢
    const vectorResults = await this.searchSimilar(query, limit * 2);
    
    // å…¨æ–‡æ¤œç´¢ï¼ˆFTS5ï¼‰
    const ftsResults = await db.execute(sql`
      SELECT 
        id,
        content,
        rank
      FROM knowledge_fts
      WHERE knowledge_fts MATCH ${query}
      ORDER BY rank
      LIMIT ${limit * 2}
    `);

    // çµæœã‚’ãƒãƒ¼ã‚¸ã—ã¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
    const scoreMap = new Map<number, number>();
    
    // ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã®ã‚¹ã‚³ã‚¢ï¼ˆè·é›¢ãŒå°ã•ã„ã»ã©é«˜ã‚¹ã‚³ã‚¢ï¼‰
    vectorResults.forEach((result, index) => {
      const score = (1 / (1 + result.distance)) * (vectorResults.length - index);
      scoreMap.set(result.id, (scoreMap.get(result.id) || 0) + score);
    });
    
    // å…¨æ–‡æ¤œç´¢ã®ã‚¹ã‚³ã‚¢
    (ftsResults as any[]).forEach((result, index) => {
      const score = (ftsResults.length - index) * 0.5;
      scoreMap.set(result.id, (scoreMap.get(result.id) || 0) + score);
    });
    
    // ã‚¹ã‚³ã‚¢ã§ã‚½ãƒ¼ãƒˆ
    return Array.from(scoreMap.entries())
      .map(([id, score]) => ({
        id,
        score,
        content: [...vectorResults, ...ftsResults].find(r => r.id === id)?.content || '',
      }))
      .sort((a, b) => b.score - a.score)
      .slice(0, limit);
  }
}
```

---

## 5. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°

### 5.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–

#### 5.1.1 ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æˆ¦ç•¥

```sql
-- è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_meeting_notes_user_project_created 
ON meetingNotes(userId, projectId, createdAt DESC);

-- éƒ¨åˆ†ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ã‚¹ã‚¯ã®ã¿ï¼‰
CREATE INDEX idx_tasks_active_due_date 
ON tasks(dueDate ASC) 
WHERE status != 'completed';

-- ã‚«ãƒãƒªãƒ³ã‚°ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆã‚¯ã‚¨ãƒªã«å¿…è¦ãªå…¨ã‚«ãƒ©ãƒ ã‚’å«ã‚€ï¼‰
CREATE INDEX idx_files_project_parent_covering 
ON files(projectId, parentFileId) 
INCLUDE (id, name, fileType, createdAt);
```

#### 5.1.2 ã‚¯ã‚¨ãƒªæœ€é©åŒ–

```typescript
// æ‚ªã„ä¾‹: N+1ã‚¯ã‚¨ãƒª
const projects = await db.query.projects.findMany();
for (const project of projects) {
  const files = await db.query.files.findMany({
    where: eq(files.projectId, project.id),
  });
}

// è‰¯ã„ä¾‹: JOINã§ä¸€åº¦ã«å–å¾—
const projectsWithFiles = await db
  .select()
  .from(projects)
  .leftJoin(files, eq(projects.id, files.projectId));
```

### 5.2 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æœ€é©åŒ–

#### 5.2.1 ã‚³ãƒ¼ãƒ‰åˆ†å‰²ã¨ãƒ¬ã‚¤ã‚¸ãƒ¼ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

```typescript
// app/(dashboard)/projects/[id]/page.tsx
import dynamic from 'next/dynamic';

// é‡ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
const GraphView = dynamic(() => import('@/components/graph/sigma-graph-view'), {
  loading: () => <GraphViewSkeleton />,
  ssr: false, // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ã¿ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
});

const FolderTree = dynamic(() => import('@/components/file/folder-tree'), {
  loading: () => <FolderTreeSkeleton />,
});
```

#### 5.2.2 ç”»åƒæœ€é©åŒ–

```typescript
// next.config.ts
const nextConfig = {
  images: {
    domains: ['s3.amazonaws.com'],
    formats: ['image/avif', 'image/webp'],
    deviceSizes: [640, 750, 828, 1080, 1200, 1920],
    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
  },
};
```

### 5.3 ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥

#### 5.3.1 Next.jsã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°

```typescript
// app/(dashboard)/projects/page.tsx
export const revalidate = 3600; // 1æ™‚é–“ã”ã¨ã«å†æ¤œè¨¼

export default async function ProjectsPage() {
  // ã“ã®ãƒ‡ãƒ¼ã‚¿ã¯1æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã‚‹
  const projects = await db.query.projects.findMany();
  
  return <ProjectsList projects={projects} />;
}
```

#### 5.3.2 React Queryã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°

```typescript
// lib/react-query-config.ts
import { QueryClient } from '@tanstack/react-query';

export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 5 * 60 * 1000, // 5åˆ†
      cacheTime: 10 * 60 * 1000, // 10åˆ†
      refetchOnWindowFocus: false,
      retry: 1,
    },
  },
});
```

---

## 6. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰

### 6.1 ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºç­–

#### 6.1.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `ECONNREFUSED` ã‚¨ãƒ©ãƒ¼

**åŸå› **: Tursoã¸ã®æ¥ç¶šãŒç¢ºç«‹ã§ããªã„

**è§£æ±ºç­–**:
```typescript
// lib/db.ts
import { createClient } from '@libsql/client';

const client = createClient({
  url: process.env.TURSO_DATABASE_URL!,
  authToken: process.env.TURSO_AUTH_TOKEN!,
  syncUrl: process.env.TURSO_SYNC_URL, // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨
});

// æ¥ç¶šãƒ—ãƒ¼ãƒ«è¨­å®š
const pool = {
  max: 10,
  min: 2,
  idleTimeoutMillis: 30000,
};
```

#### 6.1.2 ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯

**ç—‡çŠ¶**: é•·æ™‚é–“å®Ÿè¡Œã§ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒå¢—åŠ 

**åŸå› **: ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®æœªè§£é™¤ã€ã‚¿ã‚¤ãƒãƒ¼ã®æœªã‚¯ãƒªã‚¢

**è§£æ±ºç­–**:
```typescript
// useEffectã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
useEffect(() => {
  const subscription = eventBus.subscribe('event', handler);
  
  return () => {
    subscription.unsubscribe();
  };
}, []);

// ã‚¿ã‚¤ãƒãƒ¼ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
useEffect(() => {
  const interval = setInterval(() => {
    // å‡¦ç†
  }, 1000);
  
  return () => clearInterval(interval);
}, []);
```

### 6.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œã®è¨ºæ–­

#### 6.2.1 ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ãƒ„ãƒ¼ãƒ«

```typescript
// server/middleware/profiler.ts
export function profileMiddleware(handler: Function) {
  return async (req: Request, res: Response) => {
    const start = performance.now();
    
    try {
      const result = await handler(req, res);
      const duration = performance.now() - start;
      
      // ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªã‚’ãƒ­ã‚°ã«è¨˜éŒ²
      if (duration > 1000) {
        console.warn(`Slow request: ${req.url} took ${duration}ms`);
      }
      
      return result;
    } catch (error) {
      const duration = performance.now() - start;
      console.error(`Request failed after ${duration}ms:`, error);
      throw error;
    }
  };
}
```

---

## 7. æœ¬ç•ªç’°å¢ƒã§ã®è€ƒæ…®äº‹é …

### 7.1 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæˆ¦ç•¥

- **ãƒ–ãƒ«ãƒ¼ãƒ»ã‚°ãƒªãƒ¼ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ**: ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚¼ãƒ­ã§ã®ãƒªãƒªãƒ¼ã‚¹
- **ã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹**: æ®µéšçš„ãªãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ
- **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»**: å•é¡Œç™ºç”Ÿæ™‚ã®å³åº§ãªå¾©æ—§

### 7.2 ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã¨ã‚¢ãƒ©ãƒ¼ãƒˆ

- **APM**: Datadog / New Relic
- **ãƒ­ã‚°é›†ç´„**: ELK Stack / Loki
- **ãƒ¡ãƒˆãƒªã‚¯ã‚¹**: Prometheus + Grafana
- **ã‚¢ãƒ©ãƒ¼ãƒˆ**: PagerDuty / Opsgenie

---

## 8. è‡ªå‹•å®Ÿè£…ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

### ğŸ¤– è‡ªå‹•å®Ÿè£…ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚“ã AIã¯ã€ä»¥ä¸‹ã®ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼š

1. **ä¾å­˜é–¢ä¿‚ã®è§£æ±º**
```bash
# å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å…¨ã¦è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install express amqplib @aws-sdk/client-s3 @libsql/client drizzle-orm
npm install @tanstack/react-query @capacitor/core @capacitor/ios
npm install openai @types/node
```

2. **ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã®ç”Ÿæˆ**
```javascript
// è‡ªå‹•ç”Ÿæˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ
const filesToGenerate = [
  'services/audio-processing/src/index.ts',
  'services/audio-processing/src/audio-processor.ts',
  'services/ai-processing/src/index.ts',
  'services/ai-processing/src/ai-service.ts',
  'server/lib/vector-search.ts',
  'server/middleware/profiler.ts',
  // ... å…¨ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ
];
```

3. **å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã®è‡ªå‹•ç”Ÿæˆ**
   å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’çµ±åˆã—ã€å®Œå…¨ã«å‹•ä½œã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ

4. **ãƒ†ã‚¹ãƒˆã®è‡ªå‹•ä½œæˆ**
   å„æ©Ÿèƒ½ã«å¯¾ã™ã‚‹ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã€çµ±åˆãƒ†ã‚¹ãƒˆã€E2Eãƒ†ã‚¹ãƒˆã‚’ç”Ÿæˆ

5. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç›¸äº’å‚ç…§**
   ä»–ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã®æ•´åˆæ€§ã‚’ç¢ºèªã—ã€çŸ›ç›¾ã‚’è‡ªå‹•ä¿®æ­£

---

## ğŸŒ å¿…é ˆå‚ç…§ãƒªã‚½ãƒ¼ã‚¹ï¼ˆæœ€ä½10å€‹ï¼‰

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ5å€‹ä»¥ä¸Šï¼‰

1. [Next.js 14 Documentation](https://nextjs.org/docs) - ãƒ¡ã‚¤ãƒ³å…¬å¼ã‚µã‚¤ãƒˆ
2. [tRPC Documentation](https://trpc.io/docs) - å®Œå…¨ãªAPIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
3. [Turso Documentation](https://docs.turso.tech) - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆåŸå‰‡
4. [Capacitor Documentation](https://capacitorjs.com/docs) - ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªé–‹ç™º
5. [OpenAI API Reference](https://platform.openai.com/docs) - AIæ©Ÿèƒ½å®Ÿè£…

### å®Ÿè£…è¨˜äº‹ãƒ»ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ï¼ˆ5å€‹ä»¥ä¸Šï¼‰

6. [Netflix Microservices Architecture](https://netflixtechblog.com/) - å¤§è¦æ¨¡ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…äº‹ä¾‹
7. [Google Cloud Architecture Patterns](https://cloud.google.com/architecture) - ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
8. [Microsoft Azure Best Practices](https://docs.microsoft.com/azure/architecture/) - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£
9. [AWS Well-Architected Framework](https://aws.amazon.com/architecture/well-architected/) - ã‚¯ãƒ©ã‚¦ãƒ‰è¨­è¨ˆåŸå‰‡
10. [Uber Engineering Blog](https://eng.uber.com/) - å¤§è¦æ¨¡ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…çµŒé¨“

### è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹ï¼ˆãƒœãƒ¼ãƒŠã‚¹ï¼‰

11. [Martin Fowler - Microservices](https://martinfowler.com/articles/microservices.html) - ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³
12. [The Twelve-Factor App](https://12factor.net/) - ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªè¨­è¨ˆ
13. [Site Reliability Engineering Book](https://sre.google/books/) - SREå®Ÿè·µã‚¬ã‚¤ãƒ‰
14. [High Scalability Blog](http://highscalability.com/) - ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£äº‹ä¾‹
15. [InfoQ Architecture Articles](https://www.infoq.com/architecture-design/) - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æœ€æ–°å‹•å‘

---

**æ¨å®šå®Ÿè£…æ™‚é–“**: 4-6é€±é–“ï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰å®Ÿè£…ï¼‰

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: `MICROSERVICES_ORCHESTRATION.md` ã‚’å‚ç…§ã—ã¦ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹é–“ã®ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

